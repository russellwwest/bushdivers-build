import{a as e,F as s,j as a,r as c,u as M,L as v,d as T}from"./app.944e8d8e.js";import{F as d,B as k,T as _,N as F,E as N,L as w,O as C,r as $}from"./index.es.bbd55343.js";import{N as L}from"./NoContent.cc240530.js";import{d as S}from"./date.helpers.37179c42.js";import{m as g}from"./maplibre-gl.11b67a0a.js";import{p as Y}from"./general.helpers.0a3fe5e5.js";import{A as P}from"./AppLayout.595fb028.js";import"./FlashMessage.f8f9d883.js";const D=t=>(console.log(t.contract.cargo),e(s,{children:t.contract.cargo.map(i=>a("tr",{className:"bg-gray-50",children:[e("td",{children:i.id}),a("td",{children:["Current Location: ",i.current_airport_id]}),a("td",{children:["Cargo Type: ",i.cargo_type_id===1?"Cargo":"Passenger"]}),a("td",{children:["Cargo: ",i.cargo_qty.toLocaleString(navigator.language)," ",i.cargo_type_id===1?"lbs":""," ",i.cargo]}),a("td",{children:["Value: $",i.contract_value]}),a("td",{children:[e("span",{className:"text-green-500",children:i.is_completed?e(d,{icon:k}):e(s,{})}),i.active_pirep&&e(_,{content:"Active Dispatch",position:"top",children:e("span",{className:"text-orange-500",children:e(d,{icon:F})})})]})]},i.id))})),H="pk.eyJ1IjoicnVzc2VsbHd3ZXN0IiwiYSI6ImNrc29vZm5paDEweGIzMnA3MXAzYTFuMDQifQ.7veU-ARmzYClHDFsVQvT5g",j=t=>{const i=c.exports.useRef(null),l=c.exports.useRef(null),h=c.exports.useRef(null),p=c.exports.useRef(null),[u,f]=c.exports.useState(!1);c.exports.useEffect(()=>{l.current||(l.current=new g.Map({container:i.current,style:Y(t.mapStyle),center:[143.2307,-6.36188],zoom:9,accessToken:H}))}),c.exports.useEffect(()=>{if(t.data){let o=[],r=[];if(u&&(l.current.removeLayer("route"),l.current.removeSource("route"),f(!1)),o=[t.data.dep_airport.lon,t.data.dep_airport.lat],r=[t.data.arr_airport.lon,t.data.arr_airport.lat],l.current.isStyleLoaded()){l.current.addSource("route",{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:[o,r]}}}),l.current.addLayer({id:"route",type:"line",source:"route",paint:{"line-color":"#F97316","line-width":2}});const n=[o,r];l.current.fitBounds(n,{padding:50}),f(!0)}x(o),y(r)}},[t.data]);const y=o=>{h.current!==null&&h.current.remove();const r=new g.Popup({offset:25}).setText(`${t.data.arr_airport.identifier} - ${t.data.arr_airport.name}`),n=new g.Marker({color:"#F97316"}).setLngLat(o).setPopup(r).addTo(l.current);h.current=n},x=o=>{p.current!==null&&p.current.remove();const r=new g.Popup({offset:25}).setText(`${t.data.dep_airport.identifier} - ${t.data.dep_airport.name}`),n=new g.Marker({color:"#059669"}).setLngLat(o).setPopup(r).addTo(l.current);p.current=n};return e(s,{children:e("div",{ref:i,className:"map-container-"+t.size})})},A=t=>a(s,{children:[e(d,{className:"text-xl",icon:$}),e("div",{children:t.text})]}),b=t=>a(s,{children:[a("div",{children:["Altitude: ",t.airport.altitude,"ft"]}),a("div",{children:["Longest Runway: ",t.airport.longest_runway_surface," - ",t.airport.longest_runway_length.toLocaleString(navigator.language),"ft x ",t.airport.longest_runway_width,"ft"]})]}),z=({contracts:t,custom:i})=>{const{auth:l}=M().props,[h,p]=c.exports.useState(""),[u,f]=c.exports.useState(!1),y=r=>{p(r)},x=r=>{if(window.confirm("Are you sure you want to cancel this contract? You will lose XP.")){const m={id:r.id};T.Inertia.post("/contracts/cancel",m)}},o=()=>{f(!u)};return e("div",{className:"p-4",children:a("div",{className:"flex flex-col lg:flex-row justify-between mt-4",children:[a("div",{className:"lg:w-2/3 lg:mr-2",children:[e("h2",{children:"My Contracts"}),a("div",{className:"rounded shadow bg-white overflow-x-auto my-4",children:[!i&&e(L,{content:e(A,{text:"No custom contracts"})}),i&&i.length>0&&a("div",{children:[e("div",{children:e("button",{onClick:o,className:"btn btn-secondary m-2",children:"Toggle Cargo Details"})}),a("table",{className:"table-condensed table-auto",children:[e("thead",{children:a("tr",{className:"",children:[e("th",{children:"Departure"}),e("th",{children:"Arrival"}),e("th",{children:"Distance"}),e("th",{children:"Heading"}),e("th",{children:"Total Cargo"}),e("th",{children:"Value"}),e("th",{children:"Expires"}),e("td",{children:"Cancel"})]})}),e("tbody",{className:"cursor-pointer",children:i&&i.map(r=>a(s,{children:[a("tr",{onClick:()=>y(r),className:r.id===h.id?"bg-orange-200 hover:bg-orange-100":"",children:[e("td",{children:a(_,{content:e(b,{airport:r.dep_airport}),direction:"top",children:[e(v,{href:`/airports/${r.dep_airport_id}`,children:r.dep_airport_id})," ",r.dep_airport.longest_runway_surface==="W"&&e(d,{icon:N}),a("span",{className:"text-xs",children:[r.dep_airport.name," "]})]})}),e("td",{children:a(_,{content:e(b,{airport:r.arr_airport}),direction:"top",children:[e(v,{href:`/airports/${r.arr_airport_id}`,children:r.arr_airport_id})," ",r.arr_airport.longest_runway_surface==="W"&&e(d,{icon:N}),e("br",{}),e("span",{className:"text-xs",children:r.arr_airport.name})]})}),a("td",{children:[r.distance.toLocaleString(navigator.language)," nm"]}),e("td",{children:a("div",{className:"flex items-center",children:[e("div",{className:"w-1/2",children:e("span",{className:"mr-2",children:r.heading})}),e("div",{className:"w-1/2 flex",children:e("span",{style:{transform:`rotate(${r.heading}deg)`},children:e(d,{icon:w,className:"text-gray-700"})})})]})}),e("td",{children:r.cargo.map(n=>a(s,{children:[e("span",{className:"mr-1",children:n.cargo_type_id===1?"Cargo":"Pax"}),a("span",{children:[n.cargo_qty.toLocaleString(navigator.language)," ",n.cargo_type_id===1?"lbs":""," ",n.cargo]}),e("br",{})]}))}),a("td",{children:["$",parseFloat(r.cargo.map(n=>n.contract_value).reduce((n,m)=>n+Math.fround(m),0)).toFixed(2),e("br",{})]}),e("td",{children:S(r.expires_at).format("DD/MM/YYYY HH:mm")}),e("td",{children:e("button",{onClick:()=>x(r),className:"btn btn-secondary flex items-center",children:e(d,{icon:C})})})]},r.id),u&&e(D,{contract:r})]}))})]})]})]}),e("h2",{children:"Available Contracts"}),a("div",{className:"rounded shadow bg-white overflow-x-auto mt-4",children:[!t&&e(L,{content:e(A,{text:"No available contracts"})}),t&&t.length>0&&a("div",{children:[e("div",{children:e("button",{onClick:o,className:"btn btn-secondary m-2",children:"Toggle Cargo Details"})}),a("table",{className:"table-condensed table-auto",children:[e("thead",{children:a("tr",{className:"",children:[e("th",{children:"Departure"}),e("th",{children:"Arrival"}),e("th",{children:"Distance"}),e("th",{children:"Heading"}),e("th",{children:"Total Cargo"}),e("th",{children:"Value"}),e("th",{children:"Expires"}),l.user.is_admin?e("td",{children:"Cancel"}):e(s,{})]})}),e("tbody",{className:"cursor-pointer",children:t&&t.map(r=>a(s,{children:[a("tr",{onClick:()=>y(r),className:r.id===h.id?"bg-orange-200 hover:bg-orange-100 cursor-pointer":"cursor-pointer",children:[e("td",{children:a(_,{content:e(b,{airport:r.dep_airport}),direction:"top",children:[e(v,{href:`/airports/${r.dep_airport_id}`,children:r.dep_airport_id})," ",r.dep_airport.longest_runway_surface==="W"&&e(d,{icon:N}),a("span",{className:"text-xs",children:[r.dep_airport.name," "]})]})}),e("td",{children:a(_,{content:e(b,{airport:r.arr_airport}),direction:"top",children:[e(v,{href:`/airports/${r.arr_airport_id}`,children:r.arr_airport_id})," ",r.arr_airport.longest_runway_surface==="W"&&e(d,{icon:N}),e("br",{}),e("span",{className:"text-xs",children:r.arr_airport.name})]})}),a("td",{children:[r.distance.toLocaleString(navigator.language)," nm"]}),e("td",{children:a("div",{className:"flex items-center",children:[e("div",{className:"w-1/2",children:e("span",{className:"mr-2",children:r.heading})}),e("div",{className:"w-1/2 flex",children:e("span",{style:{transform:`rotate(${r.heading}deg)`},children:e(d,{icon:w,className:"text-gray-700"})})})]})}),e("td",{children:r.cargo.map(n=>a(s,{children:[e("span",{className:"mr-1",children:n.cargo_type_id===1?"Cargo":"Pax"}),a("span",{children:[n.cargo_qty.toLocaleString(navigator.language)," ",n.cargo_type_id===1?"lbs":""," ",n.cargo]}),e("br",{})]}))}),a("td",{children:["$",parseFloat(r.cargo.map(n=>n.contract_value).reduce((n,m)=>n+Math.fround(m),0)).toFixed(2),e("br",{})]}),e("td",{children:S(r.expires_at).format("DD/MM/YYYY HH:mm")}),l.user.is_admin?e("td",{children:e("button",{onClick:()=>x(r),className:"btn btn-secondary flex items-center",children:e(d,{icon:C})})}):e(s,{})]},r.id),u&&e(D,{contract:r})]}))})]})]})]})]}),e("div",{className:"lg:w-1/3 lg:ml-2 mt-2 lg:mt-0",children:t&&t.length>0&&e("div",{className:"rounded shadow bg-white p-4",children:e(j,{data:h,size:"large",mapStyle:l.user.map_style})})})]})})};z.layout=t=>e(P,{children:t,title:"Available Contracts",heading:"Available Contracts"});export{z as default};
